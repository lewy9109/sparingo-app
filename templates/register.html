{{ define "content" }}
<section class="mx-auto max-w-md">
  <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
    <h1 class="text-2xl font-semibold">Rejestracja</h1>
    <p class="mt-1 text-sm text-slate-500">Stworz konto, aby dodawac wyniki.</p>
    {{ if .Error }}
      <div class="mt-4 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700">
        {{ .Error }}
      </div>
    {{ end }}
    <form id="register-form" method="post" action="/register" class="mt-4 grid gap-4">
      <div>
        <label class="label"><span class="label-text">Imie</span></label>
        <input type="text" name="first_name" class="input input-bordered w-full" required>
      </div>
      <div>
        <label class="label"><span class="label-text">Nazwisko</span></label>
        <input type="text" name="last_name" class="input input-bordered w-full" required>
      </div>
      <div>
        <label class="label"><span class="label-text">Email</span></label>
        <input type="email" name="email" class="input input-bordered w-full" required>
      </div>
      <div>
        <label class="label"><span class="label-text">Telefon (opcjonalnie)</span></label>
        <input type="tel" name="phone" class="input input-bordered w-full" placeholder="np. 500 600 700">
      </div>
      <div>
        <label class="label"><span class="label-text">Haslo</span></label>
        <input type="password" name="password" class="input input-bordered w-full" minlength="8" required>
      </div>
      <div>
        <label class="label"><span class="label-text">Powtorz haslo</span></label>
        <input type="password" name="password_confirm" class="input input-bordered w-full" minlength="8" required>
      </div>
      <input type="hidden" name="recaptcha_token" id="recaptcha-token">
      <button class="btn btn-primary">Zarejestruj</button>
    </form>
    <p class="mt-4 text-sm text-slate-500">
      Masz juz konto?
      <a href="/login" class="link link-primary">Zaloguj sie</a>
    </p>
  </div>
</section>
{{ if .RecaptchaSiteKey }}
  <script src="https://www.google.com/recaptcha/api.js?render={{ .RecaptchaSiteKey }}"></script>
  <script>
    (function () {
      var form = document.getElementById("register-form");
      if (!form || !window.grecaptcha) {
        return;
      }
      form.addEventListener("submit", function (event) {
        event.preventDefault();
        var tokenInput = document.getElementById("recaptcha-token");
        if (!tokenInput) {
          form.submit();
          return;
        }
        window.grecaptcha.ready(function () {
          window.grecaptcha.execute("{{ .RecaptchaSiteKey }}", { action: "register" }).then(function (token) {
            tokenInput.value = token;
            form.submit();
          });
        });
      });
    })();
  </script>
{{ end }}
{{ end }}
